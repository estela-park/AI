import numpy as np
import matplotlib.pyplot as plt
from xgboost import XGBClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split

def plot_feature_importance_dataset(model):
    n_features = dataset.data.shape[1]
    plt.barh(np.arange(n_features), model.feature_importances_, align='center')
    plt.yticks(np.arange(n_features), dataset.feature_names)
    plt.xlabel('Feature Importances')
    plt.ylabel('Features')
    plt.ylim(-1, n_features)


# 1. Data-prep
dataset = load_breast_cancer()
print(dataset.data.shape)
x_train, x_test, y_train, y_test = train_test_split(dataset.data, dataset.target, train_size=0.8, random_state=76)


# 2. Modelling
model = XGBClassifier()


# 3. Training
model.fit(x_train, y_train)


# 4. Evaluation
score = model.score(x_test, y_test)
print('model.score:', score)
print(model.feature_importances_)

plot_feature_importance_dataset(model)
plt.show()
'''
            <DecisionTree>
+++  WITHOUT args
model.score: 0.9210526315789473
[0.         0.01410621 0.         0.         0.         0.
 0.         0.         0.         0.00786392 0.00181945 0.01950197
 0.         0.         0.         0.02384297 0.12484494 0.
 0.01013204 0.02205598 0.00923497 0.71474513 0.         0.        ]
+++  max_depth=3
model.score: 0.9210526315789473
[0.         0.01597353 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.14137141 0.
 0.         0.         0.         0.79106254 0.         0.        ]
+++  max_depth=4
model.score: 0.8947368421052632
[0.         0.03757431 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.01163457
 0.         0.02992068 0.         0.         0.01923054 0.
 0.         0.         0.         0.003365   0.13468188 0.
 0.         0.         0.00996263 0.75363039 0.         0.        ]
+++  max_depth=5
model.score: 0.9385964912280702
[0.         0.01649067 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.01116743
 0.         0.02871932 0.         0.01502128 0.0184584  0.
 0.         0.         0.         0.02468887 0.12927419 0.
 0.         0.         0.00956261 0.74661723 0.         0.        ]
            <RandomForest>
+++  WITHOUT args
model.score: 0.9649122807017544
[0.05063437 0.00829399 0.05605982 0.06353556 0.00461312 0.01498027
 0.0487906  0.06841927 0.00425461 0.00502585 0.02028523 0.00469386
 0.00975868 0.03571499 0.00294918 0.00704399 0.00533658 0.00380425
 0.00435899 0.00371106 0.12056539 0.01532721 0.10779745 0.09582436
 0.01164761 0.01698218 0.03102985 0.15285686 0.01675061 0.00895421]
+++  max_depth=3
model.score: 0.956140350877193
[0.05027272 0.00867017 0.0295776  0.06204616 0.00187127 0.00649164
 0.03608012 0.1152907  0.00111976 0.00161204 0.02127472 0.00087872
 0.01373385 0.07709385 0.00164929 0.00073076 0.00153001 0.00273295
 0.00074627 0.00223993 0.07365495 0.01767675 0.13453685 0.10363855
 0.00809669 0.01823321 0.03257706 0.15984656 0.01061463 0.00548223]
+++  max_depth=4 
model.score: 0.956140350877193
[0.04987576 0.01273602 0.03675388 0.04912314 0.0031303  0.01364761
 0.03082754 0.06842778 0.00266369 0.00576682 0.0125582  0.00240286
 0.00175798 0.00374205 0.07849786 0.01314565 0.14855199 0.15767942
 0.01082166 0.026034   0.03111056 0.13570206 0.01411822 0.00870628]
+++  max_depth=5
model.score: 0.9649122807017544
[0.04182932 0.01049751 0.02527367 0.05116706 0.00538111 0.00610919
 0.04920628 0.08184772 0.00264191 0.00213678 0.01910444 0.00430137
 0.00244917 0.00575276 0.09092887 0.0154812  0.12789841 0.12310642
 0.01339342 0.02706895 0.02541218 0.16936064 0.01422896 0.00593153]
            <GradientBoosting>
model.score: 0.956140350877193
[6.71825288e-03 1.77498091e-02 8.49531853e-05 4.47429914e-03
 1.40471058e-03 2.87238731e-03 2.24957795e-03 1.40427525e-02
 9.79727498e-04 1.06011625e-03 3.40235083e-03 9.92719244e-03
 6.77513285e-04 2.47773162e-02 1.49863620e-03 1.52283655e-03
 1.46619174e-02 9.81392311e-04 1.51894212e-03 3.23428331e-03
 1.65441125e-02 2.19435242e-02 2.11417016e-01 3.91937326e-03
 6.04968728e-04 3.43258313e-04 1.15297750e-02 6.08816993e-01
 1.03048585e-02 7.37153619e-04]
                <XGB>
model.score: 0.9649122807017544
[0.0074992  0.02543402 0.         0.00661605 0.00409522 0.00726947
 0.01518556 0.11075688 0.00047757 0.01056773 0.00932646 0.0119475
 0.00917309 0.01332314 0.00527652 0.00370556 0.03510939 0.00223872
 0.00431355 0.         0.06250346 0.01565041 0.2690162  0.0170965
 0.0057191  0.00355737 0.00929143 0.3315238  0.00332602 0.        ]
'''